!function(c){var r={};function l(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return c[t].call(n.exports,n,n.exports,l),n.l=!0,n.exports}l.m=c,l.c=r,l.d=function(c,r,t){l.o(c,r)||Object.defineProperty(c,r,{enumerable:!0,get:t})},l.r=function(c){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(c,"__esModule",{value:!0})},l.t=function(c,r){if(1&r&&(c=l(c)),8&r)return c;if(4&r&&"object"==typeof c&&c&&c.__esModule)return c;var t=Object.create(null);if(l.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:c}),2&r&&"string"!=typeof c)for(var n in c)l.d(t,n,function(r){return c[r]}.bind(null,n));return t},l.n=function(c){var r=c&&c.__esModule?function(){return c.default}:function(){return c};return l.d(r,"a",r),r},l.o=function(c,r){return Object.prototype.hasOwnProperty.call(c,r)},l.p="",l(l.s=0)}([function(module,exports,__webpack_require__){"use strict";eval('\r\n\r\nif ("serviceWorker" in navigator) {\r\n  window.addEventListener("load", function() {\r\n    navigator.serviceWorker.register("serviceworker.js").then(\r\n      function(registration) {\r\n        // Registration was successful\r\n        console.log(\r\n          "ServiceWorker registration successful with scope: ",\r\n          registration.scope\r\n        );\r\n      },\r\n      function(err) {\r\n        // registration failed\r\n        console.log("ServiceWorker registration failed: ", err);\r\n      }\r\n    );\r\n  });\r\n}\r\n\r\nlet canvas;\r\nlet ctx;\r\nlet gameBoardArrayHeight = 25;\r\nlet gameBoardArrayWidth = 16;\r\nlet highScore = 0;\r\nlet level = 1;\r\nconst levelUp = 20;\r\nlet pause = false;\r\nlet score = 0;\r\nlet speed = 1;\r\nlet startX = 6;\r\nlet startY = 0;\r\nlet tetrisLogo;\r\nlet time;\r\nlet winOrLose = "Playing";\r\n\r\nlocalStorage.setItem("highScore", 0);\r\nif (localStorage.getItem(highScore)) {\r\n  highScore = localStorage.getItem("highScore");\r\n} else {\r\n  localStorage.setItem("highScore", 0);\r\n}\r\n\r\nlet coordinateArray = [...Array(gameBoardArrayHeight)].map(e =>\r\n  Array(gameBoardArrayWidth).fill(0)\r\n);\r\nlet gameBoardArray = [...Array(gameBoardArrayHeight)].map(e =>\r\n  Array(gameBoardArrayWidth).fill(0)\r\n);\r\nlet stoppedShapeArray = [...Array(gameBoardArrayHeight)].map(e =>\r\n  Array(gameBoardArrayWidth).fill(0)\r\n);\r\n\r\nlet currentTetromino = [\r\n  // T Shape\r\n  [1, 0],\r\n  [0, 1],\r\n  [1, 1],\r\n  [2, 1]\r\n];\r\n\r\n//Create shapes\r\nlet tetrominos = [];\r\nfunction CreateShapes() {\r\n  // T Shape\r\n  tetrominos.push([\r\n    [1, 0],\r\n    [0, 1],\r\n    [1, 1],\r\n    [2, 1]\r\n  ]);\r\n  // I Shape\r\n  tetrominos.push([\r\n    [0, 0],\r\n    [1, 0],\r\n    [2, 0],\r\n    [3, 0]\r\n  ]);\r\n  // J Shape\r\n  tetrominos.push([\r\n    [0, 0],\r\n    [0, 1],\r\n    [1, 1],\r\n    [2, 1]\r\n  ]);\r\n  // Square Shape\r\n  tetrominos.push([\r\n    [0, 0],\r\n    [1, 0],\r\n    [0, 1],\r\n    [1, 1]\r\n  ]);\r\n  // L Shape\r\n  tetrominos.push([\r\n    [2, 0],\r\n    [0, 1],\r\n    [1, 1],\r\n    [2, 1]\r\n  ]);\r\n  // S Shape\r\n  tetrominos.push([\r\n    [1, 0],\r\n    [2, 0],\r\n    [0, 1],\r\n    [1, 1]\r\n  ]);\r\n  // Z Shape\r\n  tetrominos.push([\r\n    [0, 0],\r\n    [1, 0],\r\n    [1, 1],\r\n    [2, 1]\r\n  ]);\r\n}\r\nlet shapesColors = [\r\n  "lime",\r\n  "cyan",\r\n  "blue",\r\n  "green",\r\n  "red",\r\n  "orange",\r\n  "magenta"\r\n];\r\nlet currentTetrominoColor = "coral";\r\n\r\nlet DIRECTION = {\r\n  IDLE: 0,\r\n  DOWN: 1,\r\n  LEFT: 2,\r\n  RIGHT: 3\r\n};\r\n\r\nlet KEYS = {\r\n  LEFT: 65,\r\n  IDLE: 87,\r\n  RIGHT: 68,\r\n  DOWN: 83,\r\n  PAUSE: 80,\r\n  SPACE: 32\r\n};\r\n\r\nlet direction;\r\n\r\nclass Coordinates {\r\n  constructor(x, y) {\r\n    this.x = x;\r\n    this.y = y;\r\n  }\r\n}\r\n\r\nfunction CreateCoordArray() {\r\n  let i = 0,\r\n    j = 0;\r\n  for (let y = 4; y <= 550; y += 22) {\r\n    for (let x = 140; x <= 470; x += 22) {\r\n      coordinateArray[i][j] = new Coordinates(x, y);\r\n      i++;\r\n    }\r\n    j++;\r\n    i = 0;\r\n  }\r\n}\r\n\r\ndocument.addEventListener("DOMContentLoaded", SetupCanvas);\r\n\r\nfunction SetupCanvas() {\r\n  canvas = document.getElementById("canvas");\r\n  ctx = canvas.getContext("2d");\r\n  canvas.width = 640;\r\n  canvas.height = 558;\r\n\r\n  ctx.fillStyle = "white";\r\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n\r\n  ctx.strokeStyle = "black";\r\n  ctx.strokeRect(138, 2, 354, 552);\r\n\r\n  tetrisLogo = new Image(160, 50);\r\n  tetrisLogo.onload = DrawTetrisLogo;\r\n  tetrisLogo.src = "assets/img/indeks.jpg";\r\n\r\n  ctx.font = "1.3rem Arial";\r\n  ctx.fillStyle = "red";\r\n  ctx.fillText("Score", 500, 100);\r\n  ctx.fillText(score.toString(), 570, 100);\r\n\r\n  ctx.fillStyle = "orange";\r\n  ctx.fillText("Level", 500, 150);\r\n  ctx.fillText(level.toString(), 570, 150);\r\n\r\n  ctx.fillStyle = "green";\r\n  ctx.fillText(winOrLose, 500, 200);\r\n\r\n  ctx.fillStyle = "#0066cc";\r\n  ctx.fillText("CONTROLS", 500, 320);\r\n  ctx.fillText("A: Move left", 500, 350);\r\n  ctx.fillText("D: Move right", 500, 380);\r\n  ctx.fillText("S: Move down", 500, 410);\r\n  ctx.fillText("P: Pasue", 500, 440);\r\n  ctx.fillText("Space: Rotate", 500, 470);\r\n\r\n  document.addEventListener("keydown", handleKeyPress);\r\n\r\n  CreateShapes();\r\n  CreateTetromino();\r\n  CreateCoordArray();\r\n  DrawTetromino();\r\n}\r\n\r\nfunction DrawTetrisLogo() {\r\n  ctx.drawImage(tetrisLogo, 0, 50, 130, 70);\r\n  ctx.drawImage(tetrisLogo, 0, 100, 130, 70);\r\n  ctx.drawImage(tetrisLogo, 0, 150, 130, 70);\r\n  ctx.drawImage(tetrisLogo, 0, 200, 130, 70);\r\n  ctx.drawImage(tetrisLogo, 0, 250, 130, 70);\r\n}\r\n\r\nfunction CreateTetromino() {\r\n  let randomTetromino = Math.floor(Math.random() * tetrominos.length);\r\n  currentTetromino = tetrominos[randomTetromino];\r\n  currentTetrominoColor = shapesColors[randomTetromino];\r\n}\r\n\r\nfunction DrawTetromino() {\r\n  for (let i = 0; i < currentTetromino.length; i++) {\r\n    let x = currentTetromino[i][0] + startX;\r\n    let y = currentTetromino[i][1] + startY;\r\n    gameBoardArray[x][y] = 1;\r\n    let coorX = coordinateArray[x][y].x;\r\n    let coorY = coordinateArray[x][y].y;\r\n    ctx.fillStyle = currentTetrominoColor;\r\n    ctx.fillRect(coorX, coorY, 20, 20);\r\n  }\r\n}\r\n\r\nfunction DeleteTetromino() {\r\n  for (let i = 0; i < currentTetromino.length; i++) {\r\n    let x = currentTetromino[i][0] + startX;\r\n    let y = currentTetromino[i][1] + startY;\r\n    gameBoardArray[x][y] = 1;\r\n    let coorX = coordinateArray[x][y].x;\r\n    let coorY = coordinateArray[x][y].y;\r\n    ctx.fillStyle = "white";\r\n    ctx.fillRect(coorX, coorY, 20, 20);\r\n  }\r\n}\r\n\r\ndocument.addEventListener("keydown", handleKeyPress);\r\n\r\nfunction handleKeyPress(key) {\r\n  if (winOrLose != "Game Over") {\r\n    if (key.keyCode === KEYS.LEFT && !pause) {\r\n      MoveLeft();\r\n    } else if (key.keyCode === KEYS.RIGHT && !pause) {\r\n      MoveRight();\r\n    } else if (key.keyCode === KEYS.DOWN && !pause) {\r\n      MoveDown();\r\n    } else if (key.keyCode === KEYS.SPACE && !pause) {\r\n      RotateTetromino();\r\n    } else if (key.keyCode === KEYS.PAUSE) {\r\n      pause = !pause;\r\n      if (pause === true) {\r\n        ctx.fillStyle = "#9900cc";\r\n        ctx.fillText("PAUSE", 500, 250);\r\n      } else {\r\n        ctx.fillStyle = "white";\r\n        ctx.fillRect(500, 225, 100, 30);\r\n      }\r\n    }\r\n  }\r\n}\r\nfunction MoveLeft() {\r\n  direction = DIRECTION.LEFT;\r\n  if (!HittingTheWall() && !HorizontalCollision()) {\r\n    DeleteTetromino();\r\n    startX--;\r\n    DrawTetromino();\r\n  }\r\n}\r\n\r\nfunction MoveRight() {\r\n  direction = DIRECTION.RIGHT;\r\n  if (!HittingTheWall() && !HorizontalCollision()) {\r\n    DeleteTetromino();\r\n    startX++;\r\n    DrawTetromino();\r\n  }\r\n}\r\n\r\nfunction MoveDown() {\r\n  direction = DIRECTION.DOWN;\r\n  if (!VerticalCollision()) {\r\n    DeleteTetromino();\r\n    startY++;\r\n    DrawTetromino();\r\n  }\r\n}\r\n\r\nfunction setSpeed(speed) {\r\n  time = window.setInterval(() => {\r\n    if (!pause) {\r\n      if (winOrLose != "Game Over") {\r\n        MoveDown();\r\n      }\r\n    }\r\n  }, 1000 / speed);\r\n}\r\n\r\nsetSpeed(speed);\r\n\r\nfunction HittingTheWall() {\r\n  for (let i = 0; i < currentTetromino.length; i++) {\r\n    let newX = currentTetromino[i][0] + startX;\r\n    if (newX <= 0 && direction === DIRECTION.LEFT) {\r\n      return true;\r\n    } else if (newX >= 15 && direction === DIRECTION.RIGHT) {\r\n      return true;\r\n    }\r\n  }\r\n  return false;\r\n}\r\n\r\nfunction VerticalCollision() {\r\n  let copyTetromino = currentTetromino;\r\n  let collision = false;\r\n  for (let i = 0; i < copyTetromino.length; i++) {\r\n    let shape = copyTetromino[i];\r\n    let x = shape[0] + startX;\r\n    let y = shape[1] + startY;\r\n    if (direction === DIRECTION.DOWN) {\r\n      y++;\r\n    }\r\n\r\n    if (typeof stoppedShapeArray[x][y + 1] === "string") {\r\n      DeleteTetromino();\r\n      startY++;\r\n      DrawTetromino();\r\n      collision = true;\r\n      break;\r\n    }\r\n    if (y >= 25) {\r\n      collision = true;\r\n      break;\r\n    }\r\n  }\r\n  if (collision) {\r\n    if (startY <= 4) {\r\n      winOrLose = "Game Over";\r\n      ctx.fillStyle = "white";\r\n      ctx.fillRect(500, 180, 100, 30);\r\n      ctx.fillStyle = "black";\r\n      ctx.fillText(winOrLose, 500, 200);\r\n    } else {\r\n      for (let i = 0; i < copyTetromino.length; i++) {\r\n        let shape = copyTetromino[i];\r\n        let x = shape[0] + startX;\r\n        let y = shape[1] + startY;\r\n        stoppedShapeArray[x][y] = currentTetrominoColor;\r\n      }\r\n      CompletedRows();\r\n      CreateTetromino();\r\n      direction = DIRECTION.IDLE;\r\n      startX = 6;\r\n      startY = 0;\r\n      DrawTetromino();\r\n    }\r\n  }\r\n}\r\n\r\nfunction HorizontalCollision() {\r\n  var copyTetromino = currentTetromino;\r\n  var collision = false;\r\n  for (var i = 0; i < copyTetromino.length; i++) {\r\n    var shape = copyTetromino[i];\r\n    var x = shape[0] + startX;\r\n    var y = shape[1] + startY;\r\n\r\n    if (direction === DIRECTION.LEFT) {\r\n      x--;\r\n    } else if (direction === DIRECTION.RIGHT) {\r\n      x++;\r\n    }\r\n    var stoppedShapeValue = stoppedShapeArray[x][y];\r\n    if (typeof stoppedShapeValue === "string") {\r\n      collision = true;\r\n      break;\r\n    }\r\n  }\r\n  return collision;\r\n}\r\n\r\nfunction CompletedRows() {\r\n  var rowsToDelete = 0;\r\n  let startOfDeletion = 0;\r\n\r\n  for (let y = 0; y < gameBoardArrayHeight; y++) {\r\n    let completed = true;\r\n    for (let x = 0; x < gameBoardArrayWidth; x++) {\r\n      let shape = stoppedShapeArray[x][y];\r\n      if (shape === 0 || typeof shape === "undefined") {\r\n        completed = false;\r\n        break;\r\n      }\r\n    }\r\n    if (completed) {\r\n      if (startOfDeletion === 0) startOfDeletion = y + 4;\r\n      rowsToDelete++;\r\n      for (let i = 0; i < gameBoardArrayWidth; i++) {\r\n        stoppedShapeArray[i][y] = 0;\r\n        gameBoardArray[i][y] = 0;\r\n        let coorX = coordinateArray[i][y].x;\r\n        let coorY = coordinateArray[i][y].y;\r\n        ctx.fillStyle = "white";\r\n        ctx.fillRect(coorX, coorY, 20, 20);\r\n      }\r\n    }\r\n  }\r\n  if (rowsToDelete > 0) {\r\n    for (let i = 0; i <= 4; i++) {\r\n      console.log("i", i);\r\n    }\r\n    if (rowsToDelete === 3) {\r\n      score += 20;\r\n    }\r\n    if (rowsToDelete === 4) {\r\n      score += 30;\r\n    }\r\n    if (rowsToDelete === 5) {\r\n      score += 40;\r\n    } else {\r\n      score += 10;\r\n    }\r\n\r\n    if (score > localStorage.getItem("highScore")) {\r\n      localStorage.setItem("highScore", score);\r\n    }\r\n    ctx.fillRect(570, 85, 40, 25);\r\n    ctx.fillStyle = "green";\r\n    ctx.fillText(score.toString(), 570, 100);\r\n    MoveRowsDown(rowsToDelete, startOfDeletion);\r\n    if (score % levelUp === 0) {\r\n      speed = speed + 0.2;\r\n      level++;\r\n      ctx.fillRect(560, 130, 40, 25);\r\n      ctx.fillStyle = "green";\r\n      ctx.fillText(level.toString(), 570, 150);\r\n      clearInterval(time);\r\n      setSpeed(speed);\r\n    }\r\n  }\r\n}\r\n\r\nfunction MoveRowsDown(rowsToDelete, startOfDeletion) {\r\n  for (var i = startOfDeletion - 1; i >= 0; i--) {\r\n    for (var x = 0; x < gameBoardArrayWidth; x++) {\r\n      var y2 = i + rowsToDelete;\r\n      var shape = stoppedShapeArray[x][i];\r\n      var nextShape = stoppedShapeArray[x][y2];\r\n      if (typeof shape === "string") {\r\n        nextShape = shape;\r\n        gameBoardArray[x][y2] = 1;\r\n        stoppedShapeArray[x][y2] = shape;\r\n        let coorX = coordinateArray[x][y2].x;\r\n        let coorY = coordinateArray[x][y2].y;\r\n        ctx.fillStyle = nextShape;\r\n        ctx.fillRect(coorX, coorY, 20, 20);\r\n        shape = 0;\r\n        gameBoardArray[x][i] = 0;\r\n        stoppedShapeArray[x][i] = 0;\r\n        coorX = coordinateArray[x][i].x;\r\n        coorY = coordinateArray[x][i].y;\r\n        ctx.fillStyle = "white";\r\n        ctx.fillRect(coorX, coorY, 20, 20);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nfunction RotateTetromino() {\r\n  let newRotation = new Array();\r\n  let tetrominoCopy = currentTetromino;\r\n  let currentTetrominoBackUp;\r\n  for (let i = 0; i < tetrominoCopy.length; i++) {\r\n    currentTetrominoBackUp = [...currentTetromino];\r\n    let x = tetrominoCopy[i][0];\r\n    let y = tetrominoCopy[i][1];\r\n    let newX = GetLastSquareX() - y;\r\n    let newY = x;\r\n    newRotation.push([newX, newY]);\r\n  }\r\n  DeleteTetromino();\r\n  try {\r\n    currentTetromino = newRotation;\r\n    DrawTetromino();\r\n  } catch (e) {\r\n    if (e instanceof TypeError) {\r\n      currentTetromino = currentTetrominoBackUp;\r\n      DeleteTetromino();\r\n      DrawTetromino();\r\n    }\r\n  }\r\n}\r\nfunction GetLastSquareX() {\r\n  let lastX = 0;\r\n  for (let i = 0; i < currentTetromino.length; i++) {\r\n    let square = currentTetromino[i];\r\n    if (square[0] > lastX) lastX = square[0];\r\n  }\r\n  return lastX;\r\n}\r\n\r\n// Number of key\r\n// function keyCode(e) {\r\n//   console.log(e.keyCode);\r\n// }\r\n// window.addEventListener("keydown", keyCode);\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvanMvbWFpbi5qcz85MjkxIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFhOztBQUViO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsVUFBVTtBQUMzQixxQkFBcUIsVUFBVTtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsaUJBQWlCLDZCQUE2QjtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxpQkFBaUIsNkJBQTZCO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTs7QUFFQTtBQUNBLGlCQUFpQiw2QkFBNkI7QUFDOUM7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLDBCQUEwQjtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wscUJBQXFCLDBCQUEwQjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQiwwQkFBMEI7QUFDM0M7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBLGlCQUFpQiwwQkFBMEI7QUFDM0M7QUFDQSxtQkFBbUIseUJBQXlCO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQix5QkFBeUI7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsUUFBUTtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLG1DQUFtQyxRQUFRO0FBQzNDLG1CQUFtQix5QkFBeUI7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsMEJBQTBCO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLDZCQUE2QjtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiMC5qcyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xyXG5cclxuaWYgKFwic2VydmljZVdvcmtlclwiIGluIG5hdmlnYXRvcikge1xyXG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLCBmdW5jdGlvbigpIHtcclxuICAgIG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLnJlZ2lzdGVyKFwic2VydmljZXdvcmtlci5qc1wiKS50aGVuKFxyXG4gICAgICBmdW5jdGlvbihyZWdpc3RyYXRpb24pIHtcclxuICAgICAgICAvLyBSZWdpc3RyYXRpb24gd2FzIHN1Y2Nlc3NmdWxcclxuICAgICAgICBjb25zb2xlLmxvZyhcclxuICAgICAgICAgIFwiU2VydmljZVdvcmtlciByZWdpc3RyYXRpb24gc3VjY2Vzc2Z1bCB3aXRoIHNjb3BlOiBcIixcclxuICAgICAgICAgIHJlZ2lzdHJhdGlvbi5zY29wZVxyXG4gICAgICAgICk7XHJcbiAgICAgIH0sXHJcbiAgICAgIGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgIC8vIHJlZ2lzdHJhdGlvbiBmYWlsZWRcclxuICAgICAgICBjb25zb2xlLmxvZyhcIlNlcnZpY2VXb3JrZXIgcmVnaXN0cmF0aW9uIGZhaWxlZDogXCIsIGVycik7XHJcbiAgICAgIH1cclxuICAgICk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmxldCBjYW52YXM7XHJcbmxldCBjdHg7XHJcbmxldCBnYW1lQm9hcmRBcnJheUhlaWdodCA9IDI1O1xyXG5sZXQgZ2FtZUJvYXJkQXJyYXlXaWR0aCA9IDE2O1xyXG5sZXQgaGlnaFNjb3JlID0gMDtcclxubGV0IGxldmVsID0gMTtcclxuY29uc3QgbGV2ZWxVcCA9IDIwO1xyXG5sZXQgcGF1c2UgPSBmYWxzZTtcclxubGV0IHNjb3JlID0gMDtcclxubGV0IHNwZWVkID0gMTtcclxubGV0IHN0YXJ0WCA9IDY7XHJcbmxldCBzdGFydFkgPSAwO1xyXG5sZXQgdGV0cmlzTG9nbztcclxubGV0IHRpbWU7XHJcbmxldCB3aW5Pckxvc2UgPSBcIlBsYXlpbmdcIjtcclxuXHJcbmxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiaGlnaFNjb3JlXCIsIDApO1xyXG5pZiAobG9jYWxTdG9yYWdlLmdldEl0ZW0oaGlnaFNjb3JlKSkge1xyXG4gIGhpZ2hTY29yZSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiaGlnaFNjb3JlXCIpO1xyXG59IGVsc2Uge1xyXG4gIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiaGlnaFNjb3JlXCIsIDApO1xyXG59XHJcblxyXG5sZXQgY29vcmRpbmF0ZUFycmF5ID0gWy4uLkFycmF5KGdhbWVCb2FyZEFycmF5SGVpZ2h0KV0ubWFwKGUgPT5cclxuICBBcnJheShnYW1lQm9hcmRBcnJheVdpZHRoKS5maWxsKDApXHJcbik7XHJcbmxldCBnYW1lQm9hcmRBcnJheSA9IFsuLi5BcnJheShnYW1lQm9hcmRBcnJheUhlaWdodCldLm1hcChlID0+XHJcbiAgQXJyYXkoZ2FtZUJvYXJkQXJyYXlXaWR0aCkuZmlsbCgwKVxyXG4pO1xyXG5sZXQgc3RvcHBlZFNoYXBlQXJyYXkgPSBbLi4uQXJyYXkoZ2FtZUJvYXJkQXJyYXlIZWlnaHQpXS5tYXAoZSA9PlxyXG4gIEFycmF5KGdhbWVCb2FyZEFycmF5V2lkdGgpLmZpbGwoMClcclxuKTtcclxuXHJcbmxldCBjdXJyZW50VGV0cm9taW5vID0gW1xyXG4gIC8vIFQgU2hhcGVcclxuICBbMSwgMF0sXHJcbiAgWzAsIDFdLFxyXG4gIFsxLCAxXSxcclxuICBbMiwgMV1cclxuXTtcclxuXHJcbi8vQ3JlYXRlIHNoYXBlc1xyXG5sZXQgdGV0cm9taW5vcyA9IFtdO1xyXG5mdW5jdGlvbiBDcmVhdGVTaGFwZXMoKSB7XHJcbiAgLy8gVCBTaGFwZVxyXG4gIHRldHJvbWlub3MucHVzaChbXHJcbiAgICBbMSwgMF0sXHJcbiAgICBbMCwgMV0sXHJcbiAgICBbMSwgMV0sXHJcbiAgICBbMiwgMV1cclxuICBdKTtcclxuICAvLyBJIFNoYXBlXHJcbiAgdGV0cm9taW5vcy5wdXNoKFtcclxuICAgIFswLCAwXSxcclxuICAgIFsxLCAwXSxcclxuICAgIFsyLCAwXSxcclxuICAgIFszLCAwXVxyXG4gIF0pO1xyXG4gIC8vIEogU2hhcGVcclxuICB0ZXRyb21pbm9zLnB1c2goW1xyXG4gICAgWzAsIDBdLFxyXG4gICAgWzAsIDFdLFxyXG4gICAgWzEsIDFdLFxyXG4gICAgWzIsIDFdXHJcbiAgXSk7XHJcbiAgLy8gU3F1YXJlIFNoYXBlXHJcbiAgdGV0cm9taW5vcy5wdXNoKFtcclxuICAgIFswLCAwXSxcclxuICAgIFsxLCAwXSxcclxuICAgIFswLCAxXSxcclxuICAgIFsxLCAxXVxyXG4gIF0pO1xyXG4gIC8vIEwgU2hhcGVcclxuICB0ZXRyb21pbm9zLnB1c2goW1xyXG4gICAgWzIsIDBdLFxyXG4gICAgWzAsIDFdLFxyXG4gICAgWzEsIDFdLFxyXG4gICAgWzIsIDFdXHJcbiAgXSk7XHJcbiAgLy8gUyBTaGFwZVxyXG4gIHRldHJvbWlub3MucHVzaChbXHJcbiAgICBbMSwgMF0sXHJcbiAgICBbMiwgMF0sXHJcbiAgICBbMCwgMV0sXHJcbiAgICBbMSwgMV1cclxuICBdKTtcclxuICAvLyBaIFNoYXBlXHJcbiAgdGV0cm9taW5vcy5wdXNoKFtcclxuICAgIFswLCAwXSxcclxuICAgIFsxLCAwXSxcclxuICAgIFsxLCAxXSxcclxuICAgIFsyLCAxXVxyXG4gIF0pO1xyXG59XHJcbmxldCBzaGFwZXNDb2xvcnMgPSBbXHJcbiAgXCJsaW1lXCIsXHJcbiAgXCJjeWFuXCIsXHJcbiAgXCJibHVlXCIsXHJcbiAgXCJncmVlblwiLFxyXG4gIFwicmVkXCIsXHJcbiAgXCJvcmFuZ2VcIixcclxuICBcIm1hZ2VudGFcIlxyXG5dO1xyXG5sZXQgY3VycmVudFRldHJvbWlub0NvbG9yID0gXCJjb3JhbFwiO1xyXG5cclxubGV0IERJUkVDVElPTiA9IHtcclxuICBJRExFOiAwLFxyXG4gIERPV046IDEsXHJcbiAgTEVGVDogMixcclxuICBSSUdIVDogM1xyXG59O1xyXG5cclxubGV0IEtFWVMgPSB7XHJcbiAgTEVGVDogNjUsXHJcbiAgSURMRTogODcsXHJcbiAgUklHSFQ6IDY4LFxyXG4gIERPV046IDgzLFxyXG4gIFBBVVNFOiA4MCxcclxuICBTUEFDRTogMzJcclxufTtcclxuXHJcbmxldCBkaXJlY3Rpb247XHJcblxyXG5jbGFzcyBDb29yZGluYXRlcyB7XHJcbiAgY29uc3RydWN0b3IoeCwgeSkge1xyXG4gICAgdGhpcy54ID0geDtcclxuICAgIHRoaXMueSA9IHk7XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBDcmVhdGVDb29yZEFycmF5KCkge1xyXG4gIGxldCBpID0gMCxcclxuICAgIGogPSAwO1xyXG4gIGZvciAobGV0IHkgPSA0OyB5IDw9IDU1MDsgeSArPSAyMikge1xyXG4gICAgZm9yIChsZXQgeCA9IDE0MDsgeCA8PSA0NzA7IHggKz0gMjIpIHtcclxuICAgICAgY29vcmRpbmF0ZUFycmF5W2ldW2pdID0gbmV3IENvb3JkaW5hdGVzKHgsIHkpO1xyXG4gICAgICBpKys7XHJcbiAgICB9XHJcbiAgICBqKys7XHJcbiAgICBpID0gMDtcclxuICB9XHJcbn1cclxuXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsIFNldHVwQ2FudmFzKTtcclxuXHJcbmZ1bmN0aW9uIFNldHVwQ2FudmFzKCkge1xyXG4gIGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2FudmFzXCIpO1xyXG4gIGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XHJcbiAgY2FudmFzLndpZHRoID0gNjQwO1xyXG4gIGNhbnZhcy5oZWlnaHQgPSA1NTg7XHJcblxyXG4gIGN0eC5maWxsU3R5bGUgPSBcIndoaXRlXCI7XHJcbiAgY3R4LmZpbGxSZWN0KDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7XHJcblxyXG4gIGN0eC5zdHJva2VTdHlsZSA9IFwiYmxhY2tcIjtcclxuICBjdHguc3Ryb2tlUmVjdCgxMzgsIDIsIDM1NCwgNTUyKTtcclxuXHJcbiAgdGV0cmlzTG9nbyA9IG5ldyBJbWFnZSgxNjAsIDUwKTtcclxuICB0ZXRyaXNMb2dvLm9ubG9hZCA9IERyYXdUZXRyaXNMb2dvO1xyXG4gIHRldHJpc0xvZ28uc3JjID0gXCJhc3NldHMvaW1nL2luZGVrcy5qcGdcIjtcclxuXHJcbiAgY3R4LmZvbnQgPSBcIjEuM3JlbSBBcmlhbFwiO1xyXG4gIGN0eC5maWxsU3R5bGUgPSBcInJlZFwiO1xyXG4gIGN0eC5maWxsVGV4dChcIlNjb3JlXCIsIDUwMCwgMTAwKTtcclxuICBjdHguZmlsbFRleHQoc2NvcmUudG9TdHJpbmcoKSwgNTcwLCAxMDApO1xyXG5cclxuICBjdHguZmlsbFN0eWxlID0gXCJvcmFuZ2VcIjtcclxuICBjdHguZmlsbFRleHQoXCJMZXZlbFwiLCA1MDAsIDE1MCk7XHJcbiAgY3R4LmZpbGxUZXh0KGxldmVsLnRvU3RyaW5nKCksIDU3MCwgMTUwKTtcclxuXHJcbiAgY3R4LmZpbGxTdHlsZSA9IFwiZ3JlZW5cIjtcclxuICBjdHguZmlsbFRleHQod2luT3JMb3NlLCA1MDAsIDIwMCk7XHJcblxyXG4gIGN0eC5maWxsU3R5bGUgPSBcIiMwMDY2Y2NcIjtcclxuICBjdHguZmlsbFRleHQoXCJDT05UUk9MU1wiLCA1MDAsIDMyMCk7XHJcbiAgY3R4LmZpbGxUZXh0KFwiQTogTW92ZSBsZWZ0XCIsIDUwMCwgMzUwKTtcclxuICBjdHguZmlsbFRleHQoXCJEOiBNb3ZlIHJpZ2h0XCIsIDUwMCwgMzgwKTtcclxuICBjdHguZmlsbFRleHQoXCJTOiBNb3ZlIGRvd25cIiwgNTAwLCA0MTApO1xyXG4gIGN0eC5maWxsVGV4dChcIlA6IFBhc3VlXCIsIDUwMCwgNDQwKTtcclxuICBjdHguZmlsbFRleHQoXCJTcGFjZTogUm90YXRlXCIsIDUwMCwgNDcwKTtcclxuXHJcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgaGFuZGxlS2V5UHJlc3MpO1xyXG5cclxuICBDcmVhdGVTaGFwZXMoKTtcclxuICBDcmVhdGVUZXRyb21pbm8oKTtcclxuICBDcmVhdGVDb29yZEFycmF5KCk7XHJcbiAgRHJhd1RldHJvbWlubygpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBEcmF3VGV0cmlzTG9nbygpIHtcclxuICBjdHguZHJhd0ltYWdlKHRldHJpc0xvZ28sIDAsIDUwLCAxMzAsIDcwKTtcclxuICBjdHguZHJhd0ltYWdlKHRldHJpc0xvZ28sIDAsIDEwMCwgMTMwLCA3MCk7XHJcbiAgY3R4LmRyYXdJbWFnZSh0ZXRyaXNMb2dvLCAwLCAxNTAsIDEzMCwgNzApO1xyXG4gIGN0eC5kcmF3SW1hZ2UodGV0cmlzTG9nbywgMCwgMjAwLCAxMzAsIDcwKTtcclxuICBjdHguZHJhd0ltYWdlKHRldHJpc0xvZ28sIDAsIDI1MCwgMTMwLCA3MCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIENyZWF0ZVRldHJvbWlubygpIHtcclxuICBsZXQgcmFuZG9tVGV0cm9taW5vID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogdGV0cm9taW5vcy5sZW5ndGgpO1xyXG4gIGN1cnJlbnRUZXRyb21pbm8gPSB0ZXRyb21pbm9zW3JhbmRvbVRldHJvbWlub107XHJcbiAgY3VycmVudFRldHJvbWlub0NvbG9yID0gc2hhcGVzQ29sb3JzW3JhbmRvbVRldHJvbWlub107XHJcbn1cclxuXHJcbmZ1bmN0aW9uIERyYXdUZXRyb21pbm8oKSB7XHJcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBjdXJyZW50VGV0cm9taW5vLmxlbmd0aDsgaSsrKSB7XHJcbiAgICBsZXQgeCA9IGN1cnJlbnRUZXRyb21pbm9baV1bMF0gKyBzdGFydFg7XHJcbiAgICBsZXQgeSA9IGN1cnJlbnRUZXRyb21pbm9baV1bMV0gKyBzdGFydFk7XHJcbiAgICBnYW1lQm9hcmRBcnJheVt4XVt5XSA9IDE7XHJcbiAgICBsZXQgY29vclggPSBjb29yZGluYXRlQXJyYXlbeF1beV0ueDtcclxuICAgIGxldCBjb29yWSA9IGNvb3JkaW5hdGVBcnJheVt4XVt5XS55O1xyXG4gICAgY3R4LmZpbGxTdHlsZSA9IGN1cnJlbnRUZXRyb21pbm9Db2xvcjtcclxuICAgIGN0eC5maWxsUmVjdChjb29yWCwgY29vclksIDIwLCAyMCk7XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBEZWxldGVUZXRyb21pbm8oKSB7XHJcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBjdXJyZW50VGV0cm9taW5vLmxlbmd0aDsgaSsrKSB7XHJcbiAgICBsZXQgeCA9IGN1cnJlbnRUZXRyb21pbm9baV1bMF0gKyBzdGFydFg7XHJcbiAgICBsZXQgeSA9IGN1cnJlbnRUZXRyb21pbm9baV1bMV0gKyBzdGFydFk7XHJcbiAgICBnYW1lQm9hcmRBcnJheVt4XVt5XSA9IDE7XHJcbiAgICBsZXQgY29vclggPSBjb29yZGluYXRlQXJyYXlbeF1beV0ueDtcclxuICAgIGxldCBjb29yWSA9IGNvb3JkaW5hdGVBcnJheVt4XVt5XS55O1xyXG4gICAgY3R4LmZpbGxTdHlsZSA9IFwid2hpdGVcIjtcclxuICAgIGN0eC5maWxsUmVjdChjb29yWCwgY29vclksIDIwLCAyMCk7XHJcbiAgfVxyXG59XHJcblxyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVLZXlQcmVzcyk7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVLZXlQcmVzcyhrZXkpIHtcclxuICBpZiAod2luT3JMb3NlICE9IFwiR2FtZSBPdmVyXCIpIHtcclxuICAgIGlmIChrZXkua2V5Q29kZSA9PT0gS0VZUy5MRUZUICYmICFwYXVzZSkge1xyXG4gICAgICBNb3ZlTGVmdCgpO1xyXG4gICAgfSBlbHNlIGlmIChrZXkua2V5Q29kZSA9PT0gS0VZUy5SSUdIVCAmJiAhcGF1c2UpIHtcclxuICAgICAgTW92ZVJpZ2h0KCk7XHJcbiAgICB9IGVsc2UgaWYgKGtleS5rZXlDb2RlID09PSBLRVlTLkRPV04gJiYgIXBhdXNlKSB7XHJcbiAgICAgIE1vdmVEb3duKCk7XHJcbiAgICB9IGVsc2UgaWYgKGtleS5rZXlDb2RlID09PSBLRVlTLlNQQUNFICYmICFwYXVzZSkge1xyXG4gICAgICBSb3RhdGVUZXRyb21pbm8oKTtcclxuICAgIH0gZWxzZSBpZiAoa2V5LmtleUNvZGUgPT09IEtFWVMuUEFVU0UpIHtcclxuICAgICAgcGF1c2UgPSAhcGF1c2U7XHJcbiAgICAgIGlmIChwYXVzZSA9PT0gdHJ1ZSkge1xyXG4gICAgICAgIGN0eC5maWxsU3R5bGUgPSBcIiM5OTAwY2NcIjtcclxuICAgICAgICBjdHguZmlsbFRleHQoXCJQQVVTRVwiLCA1MDAsIDI1MCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY3R4LmZpbGxTdHlsZSA9IFwid2hpdGVcIjtcclxuICAgICAgICBjdHguZmlsbFJlY3QoNTAwLCAyMjUsIDEwMCwgMzApO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbmZ1bmN0aW9uIE1vdmVMZWZ0KCkge1xyXG4gIGRpcmVjdGlvbiA9IERJUkVDVElPTi5MRUZUO1xyXG4gIGlmICghSGl0dGluZ1RoZVdhbGwoKSAmJiAhSG9yaXpvbnRhbENvbGxpc2lvbigpKSB7XHJcbiAgICBEZWxldGVUZXRyb21pbm8oKTtcclxuICAgIHN0YXJ0WC0tO1xyXG4gICAgRHJhd1RldHJvbWlubygpO1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gTW92ZVJpZ2h0KCkge1xyXG4gIGRpcmVjdGlvbiA9IERJUkVDVElPTi5SSUdIVDtcclxuICBpZiAoIUhpdHRpbmdUaGVXYWxsKCkgJiYgIUhvcml6b250YWxDb2xsaXNpb24oKSkge1xyXG4gICAgRGVsZXRlVGV0cm9taW5vKCk7XHJcbiAgICBzdGFydFgrKztcclxuICAgIERyYXdUZXRyb21pbm8oKTtcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIE1vdmVEb3duKCkge1xyXG4gIGRpcmVjdGlvbiA9IERJUkVDVElPTi5ET1dOO1xyXG4gIGlmICghVmVydGljYWxDb2xsaXNpb24oKSkge1xyXG4gICAgRGVsZXRlVGV0cm9taW5vKCk7XHJcbiAgICBzdGFydFkrKztcclxuICAgIERyYXdUZXRyb21pbm8oKTtcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNldFNwZWVkKHNwZWVkKSB7XHJcbiAgdGltZSA9IHdpbmRvdy5zZXRJbnRlcnZhbCgoKSA9PiB7XHJcbiAgICBpZiAoIXBhdXNlKSB7XHJcbiAgICAgIGlmICh3aW5Pckxvc2UgIT0gXCJHYW1lIE92ZXJcIikge1xyXG4gICAgICAgIE1vdmVEb3duKCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9LCAxMDAwIC8gc3BlZWQpO1xyXG59XHJcblxyXG5zZXRTcGVlZChzcGVlZCk7XHJcblxyXG5mdW5jdGlvbiBIaXR0aW5nVGhlV2FsbCgpIHtcclxuICBmb3IgKGxldCBpID0gMDsgaSA8IGN1cnJlbnRUZXRyb21pbm8ubGVuZ3RoOyBpKyspIHtcclxuICAgIGxldCBuZXdYID0gY3VycmVudFRldHJvbWlub1tpXVswXSArIHN0YXJ0WDtcclxuICAgIGlmIChuZXdYIDw9IDAgJiYgZGlyZWN0aW9uID09PSBESVJFQ1RJT04uTEVGVCkge1xyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH0gZWxzZSBpZiAobmV3WCA+PSAxNSAmJiBkaXJlY3Rpb24gPT09IERJUkVDVElPTi5SSUdIVCkge1xyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuICB9XHJcbiAgcmV0dXJuIGZhbHNlO1xyXG59XHJcblxyXG5mdW5jdGlvbiBWZXJ0aWNhbENvbGxpc2lvbigpIHtcclxuICBsZXQgY29weVRldHJvbWlubyA9IGN1cnJlbnRUZXRyb21pbm87XHJcbiAgbGV0IGNvbGxpc2lvbiA9IGZhbHNlO1xyXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgY29weVRldHJvbWluby5sZW5ndGg7IGkrKykge1xyXG4gICAgbGV0IHNoYXBlID0gY29weVRldHJvbWlub1tpXTtcclxuICAgIGxldCB4ID0gc2hhcGVbMF0gKyBzdGFydFg7XHJcbiAgICBsZXQgeSA9IHNoYXBlWzFdICsgc3RhcnRZO1xyXG4gICAgaWYgKGRpcmVjdGlvbiA9PT0gRElSRUNUSU9OLkRPV04pIHtcclxuICAgICAgeSsrO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICh0eXBlb2Ygc3RvcHBlZFNoYXBlQXJyYXlbeF1beSArIDFdID09PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgIERlbGV0ZVRldHJvbWlubygpO1xyXG4gICAgICBzdGFydFkrKztcclxuICAgICAgRHJhd1RldHJvbWlubygpO1xyXG4gICAgICBjb2xsaXNpb24gPSB0cnVlO1xyXG4gICAgICBicmVhaztcclxuICAgIH1cclxuICAgIGlmICh5ID49IDI1KSB7XHJcbiAgICAgIGNvbGxpc2lvbiA9IHRydWU7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG4gIH1cclxuICBpZiAoY29sbGlzaW9uKSB7XHJcbiAgICBpZiAoc3RhcnRZIDw9IDQpIHtcclxuICAgICAgd2luT3JMb3NlID0gXCJHYW1lIE92ZXJcIjtcclxuICAgICAgY3R4LmZpbGxTdHlsZSA9IFwid2hpdGVcIjtcclxuICAgICAgY3R4LmZpbGxSZWN0KDUwMCwgMTgwLCAxMDAsIDMwKTtcclxuICAgICAgY3R4LmZpbGxTdHlsZSA9IFwiYmxhY2tcIjtcclxuICAgICAgY3R4LmZpbGxUZXh0KHdpbk9yTG9zZSwgNTAwLCAyMDApO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3B5VGV0cm9taW5vLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgbGV0IHNoYXBlID0gY29weVRldHJvbWlub1tpXTtcclxuICAgICAgICBsZXQgeCA9IHNoYXBlWzBdICsgc3RhcnRYO1xyXG4gICAgICAgIGxldCB5ID0gc2hhcGVbMV0gKyBzdGFydFk7XHJcbiAgICAgICAgc3RvcHBlZFNoYXBlQXJyYXlbeF1beV0gPSBjdXJyZW50VGV0cm9taW5vQ29sb3I7XHJcbiAgICAgIH1cclxuICAgICAgQ29tcGxldGVkUm93cygpO1xyXG4gICAgICBDcmVhdGVUZXRyb21pbm8oKTtcclxuICAgICAgZGlyZWN0aW9uID0gRElSRUNUSU9OLklETEU7XHJcbiAgICAgIHN0YXJ0WCA9IDY7XHJcbiAgICAgIHN0YXJ0WSA9IDA7XHJcbiAgICAgIERyYXdUZXRyb21pbm8oKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIEhvcml6b250YWxDb2xsaXNpb24oKSB7XHJcbiAgdmFyIGNvcHlUZXRyb21pbm8gPSBjdXJyZW50VGV0cm9taW5vO1xyXG4gIHZhciBjb2xsaXNpb24gPSBmYWxzZTtcclxuICBmb3IgKHZhciBpID0gMDsgaSA8IGNvcHlUZXRyb21pbm8ubGVuZ3RoOyBpKyspIHtcclxuICAgIHZhciBzaGFwZSA9IGNvcHlUZXRyb21pbm9baV07XHJcbiAgICB2YXIgeCA9IHNoYXBlWzBdICsgc3RhcnRYO1xyXG4gICAgdmFyIHkgPSBzaGFwZVsxXSArIHN0YXJ0WTtcclxuXHJcbiAgICBpZiAoZGlyZWN0aW9uID09PSBESVJFQ1RJT04uTEVGVCkge1xyXG4gICAgICB4LS07XHJcbiAgICB9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PT0gRElSRUNUSU9OLlJJR0hUKSB7XHJcbiAgICAgIHgrKztcclxuICAgIH1cclxuICAgIHZhciBzdG9wcGVkU2hhcGVWYWx1ZSA9IHN0b3BwZWRTaGFwZUFycmF5W3hdW3ldO1xyXG4gICAgaWYgKHR5cGVvZiBzdG9wcGVkU2hhcGVWYWx1ZSA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICBjb2xsaXNpb24gPSB0cnVlO1xyXG4gICAgICBicmVhaztcclxuICAgIH1cclxuICB9XHJcbiAgcmV0dXJuIGNvbGxpc2lvbjtcclxufVxyXG5cclxuZnVuY3Rpb24gQ29tcGxldGVkUm93cygpIHtcclxuICB2YXIgcm93c1RvRGVsZXRlID0gMDtcclxuICBsZXQgc3RhcnRPZkRlbGV0aW9uID0gMDtcclxuXHJcbiAgZm9yIChsZXQgeSA9IDA7IHkgPCBnYW1lQm9hcmRBcnJheUhlaWdodDsgeSsrKSB7XHJcbiAgICBsZXQgY29tcGxldGVkID0gdHJ1ZTtcclxuICAgIGZvciAobGV0IHggPSAwOyB4IDwgZ2FtZUJvYXJkQXJyYXlXaWR0aDsgeCsrKSB7XHJcbiAgICAgIGxldCBzaGFwZSA9IHN0b3BwZWRTaGFwZUFycmF5W3hdW3ldO1xyXG4gICAgICBpZiAoc2hhcGUgPT09IDAgfHwgdHlwZW9mIHNoYXBlID09PSBcInVuZGVmaW5lZFwiKSB7XHJcbiAgICAgICAgY29tcGxldGVkID0gZmFsc2U7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGlmIChjb21wbGV0ZWQpIHtcclxuICAgICAgaWYgKHN0YXJ0T2ZEZWxldGlvbiA9PT0gMCkgc3RhcnRPZkRlbGV0aW9uID0geSArIDQ7XHJcbiAgICAgIHJvd3NUb0RlbGV0ZSsrO1xyXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGdhbWVCb2FyZEFycmF5V2lkdGg7IGkrKykge1xyXG4gICAgICAgIHN0b3BwZWRTaGFwZUFycmF5W2ldW3ldID0gMDtcclxuICAgICAgICBnYW1lQm9hcmRBcnJheVtpXVt5XSA9IDA7XHJcbiAgICAgICAgbGV0IGNvb3JYID0gY29vcmRpbmF0ZUFycmF5W2ldW3ldLng7XHJcbiAgICAgICAgbGV0IGNvb3JZID0gY29vcmRpbmF0ZUFycmF5W2ldW3ldLnk7XHJcbiAgICAgICAgY3R4LmZpbGxTdHlsZSA9IFwid2hpdGVcIjtcclxuICAgICAgICBjdHguZmlsbFJlY3QoY29vclgsIGNvb3JZLCAyMCwgMjApO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG4gIGlmIChyb3dzVG9EZWxldGUgPiAwKSB7XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8PSA0OyBpKyspIHtcclxuICAgICAgY29uc29sZS5sb2coXCJpXCIsIGkpO1xyXG4gICAgfVxyXG4gICAgaWYgKHJvd3NUb0RlbGV0ZSA9PT0gMykge1xyXG4gICAgICBzY29yZSArPSAyMDtcclxuICAgIH1cclxuICAgIGlmIChyb3dzVG9EZWxldGUgPT09IDQpIHtcclxuICAgICAgc2NvcmUgKz0gMzA7XHJcbiAgICB9XHJcbiAgICBpZiAocm93c1RvRGVsZXRlID09PSA1KSB7XHJcbiAgICAgIHNjb3JlICs9IDQwO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgc2NvcmUgKz0gMTA7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHNjb3JlID4gbG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJoaWdoU2NvcmVcIikpIHtcclxuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJoaWdoU2NvcmVcIiwgc2NvcmUpO1xyXG4gICAgfVxyXG4gICAgY3R4LmZpbGxSZWN0KDU3MCwgODUsIDQwLCAyNSk7XHJcbiAgICBjdHguZmlsbFN0eWxlID0gXCJncmVlblwiO1xyXG4gICAgY3R4LmZpbGxUZXh0KHNjb3JlLnRvU3RyaW5nKCksIDU3MCwgMTAwKTtcclxuICAgIE1vdmVSb3dzRG93bihyb3dzVG9EZWxldGUsIHN0YXJ0T2ZEZWxldGlvbik7XHJcbiAgICBpZiAoc2NvcmUgJSBsZXZlbFVwID09PSAwKSB7XHJcbiAgICAgIHNwZWVkID0gc3BlZWQgKyAwLjI7XHJcbiAgICAgIGxldmVsKys7XHJcbiAgICAgIGN0eC5maWxsUmVjdCg1NjAsIDEzMCwgNDAsIDI1KTtcclxuICAgICAgY3R4LmZpbGxTdHlsZSA9IFwiZ3JlZW5cIjtcclxuICAgICAgY3R4LmZpbGxUZXh0KGxldmVsLnRvU3RyaW5nKCksIDU3MCwgMTUwKTtcclxuICAgICAgY2xlYXJJbnRlcnZhbCh0aW1lKTtcclxuICAgICAgc2V0U3BlZWQoc3BlZWQpO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gTW92ZVJvd3NEb3duKHJvd3NUb0RlbGV0ZSwgc3RhcnRPZkRlbGV0aW9uKSB7XHJcbiAgZm9yICh2YXIgaSA9IHN0YXJ0T2ZEZWxldGlvbiAtIDE7IGkgPj0gMDsgaS0tKSB7XHJcbiAgICBmb3IgKHZhciB4ID0gMDsgeCA8IGdhbWVCb2FyZEFycmF5V2lkdGg7IHgrKykge1xyXG4gICAgICB2YXIgeTIgPSBpICsgcm93c1RvRGVsZXRlO1xyXG4gICAgICB2YXIgc2hhcGUgPSBzdG9wcGVkU2hhcGVBcnJheVt4XVtpXTtcclxuICAgICAgdmFyIG5leHRTaGFwZSA9IHN0b3BwZWRTaGFwZUFycmF5W3hdW3kyXTtcclxuICAgICAgaWYgKHR5cGVvZiBzaGFwZSA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgIG5leHRTaGFwZSA9IHNoYXBlO1xyXG4gICAgICAgIGdhbWVCb2FyZEFycmF5W3hdW3kyXSA9IDE7XHJcbiAgICAgICAgc3RvcHBlZFNoYXBlQXJyYXlbeF1beTJdID0gc2hhcGU7XHJcbiAgICAgICAgbGV0IGNvb3JYID0gY29vcmRpbmF0ZUFycmF5W3hdW3kyXS54O1xyXG4gICAgICAgIGxldCBjb29yWSA9IGNvb3JkaW5hdGVBcnJheVt4XVt5Ml0ueTtcclxuICAgICAgICBjdHguZmlsbFN0eWxlID0gbmV4dFNoYXBlO1xyXG4gICAgICAgIGN0eC5maWxsUmVjdChjb29yWCwgY29vclksIDIwLCAyMCk7XHJcbiAgICAgICAgc2hhcGUgPSAwO1xyXG4gICAgICAgIGdhbWVCb2FyZEFycmF5W3hdW2ldID0gMDtcclxuICAgICAgICBzdG9wcGVkU2hhcGVBcnJheVt4XVtpXSA9IDA7XHJcbiAgICAgICAgY29vclggPSBjb29yZGluYXRlQXJyYXlbeF1baV0ueDtcclxuICAgICAgICBjb29yWSA9IGNvb3JkaW5hdGVBcnJheVt4XVtpXS55O1xyXG4gICAgICAgIGN0eC5maWxsU3R5bGUgPSBcIndoaXRlXCI7XHJcbiAgICAgICAgY3R4LmZpbGxSZWN0KGNvb3JYLCBjb29yWSwgMjAsIDIwKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gUm90YXRlVGV0cm9taW5vKCkge1xyXG4gIGxldCBuZXdSb3RhdGlvbiA9IG5ldyBBcnJheSgpO1xyXG4gIGxldCB0ZXRyb21pbm9Db3B5ID0gY3VycmVudFRldHJvbWlubztcclxuICBsZXQgY3VycmVudFRldHJvbWlub0JhY2tVcDtcclxuICBmb3IgKGxldCBpID0gMDsgaSA8IHRldHJvbWlub0NvcHkubGVuZ3RoOyBpKyspIHtcclxuICAgIGN1cnJlbnRUZXRyb21pbm9CYWNrVXAgPSBbLi4uY3VycmVudFRldHJvbWlub107XHJcbiAgICBsZXQgeCA9IHRldHJvbWlub0NvcHlbaV1bMF07XHJcbiAgICBsZXQgeSA9IHRldHJvbWlub0NvcHlbaV1bMV07XHJcbiAgICBsZXQgbmV3WCA9IEdldExhc3RTcXVhcmVYKCkgLSB5O1xyXG4gICAgbGV0IG5ld1kgPSB4O1xyXG4gICAgbmV3Um90YXRpb24ucHVzaChbbmV3WCwgbmV3WV0pO1xyXG4gIH1cclxuICBEZWxldGVUZXRyb21pbm8oKTtcclxuICB0cnkge1xyXG4gICAgY3VycmVudFRldHJvbWlubyA9IG5ld1JvdGF0aW9uO1xyXG4gICAgRHJhd1RldHJvbWlubygpO1xyXG4gIH0gY2F0Y2ggKGUpIHtcclxuICAgIGlmIChlIGluc3RhbmNlb2YgVHlwZUVycm9yKSB7XHJcbiAgICAgIGN1cnJlbnRUZXRyb21pbm8gPSBjdXJyZW50VGV0cm9taW5vQmFja1VwO1xyXG4gICAgICBEZWxldGVUZXRyb21pbm8oKTtcclxuICAgICAgRHJhd1RldHJvbWlubygpO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5mdW5jdGlvbiBHZXRMYXN0U3F1YXJlWCgpIHtcclxuICBsZXQgbGFzdFggPSAwO1xyXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgY3VycmVudFRldHJvbWluby5sZW5ndGg7IGkrKykge1xyXG4gICAgbGV0IHNxdWFyZSA9IGN1cnJlbnRUZXRyb21pbm9baV07XHJcbiAgICBpZiAoc3F1YXJlWzBdID4gbGFzdFgpIGxhc3RYID0gc3F1YXJlWzBdO1xyXG4gIH1cclxuICByZXR1cm4gbGFzdFg7XHJcbn1cclxuXHJcbi8vIE51bWJlciBvZiBrZXlcclxuLy8gZnVuY3Rpb24ga2V5Q29kZShlKSB7XHJcbi8vICAgY29uc29sZS5sb2coZS5rZXlDb2RlKTtcclxuLy8gfVxyXG4vLyB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwga2V5Q29kZSk7XHJcbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///0\n')}]);